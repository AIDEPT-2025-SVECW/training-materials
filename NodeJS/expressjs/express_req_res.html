<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Express.js Request & Response Handling</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .content {
            padding: 40px;
        }
        
        .section {
            margin-bottom: 40px;
            padding: 25px;
            background: #f7fafc;
            border-radius: 10px;
            border-left: 5px solid #667eea;
        }
        
        .section h2 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.8em;
        }
        
        .section h3 {
            color: #4a5568;
            margin: 20px 0 10px 0;
            font-size: 1.3em;
        }
        
        .analogy {
            background: #fff5e6;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        
        .analogy strong {
            color: #f59e0b;
            display: block;
            margin-bottom: 8px;
            font-size: 1.1em;
        }
        
        pre {
            background: #1e293b;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .keyword { color: #c792ea; }
        .string { color: #c3e88d; }
        .comment { color: #676e95; font-style: italic; }
        .function { color: #82aaff; }
        .property { color: #f07178; }
        
        .interactive-demo {
            background: white;
            padding: 25px;
            border-radius: 10px;
            border: 2px solid #667eea;
            margin: 20px 0;
        }
        
        .demo-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
        }
        
        label {
            font-weight: 600;
            margin-bottom: 5px;
            color: #2d3748;
        }
        
        input, select {
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 5px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .output {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            border: 2px solid #e2e8f0;
        }
        
        .output h4 {
            color: #2d3748;
            margin-bottom: 15px;
        }
        
        .output-item {
            background: white;
            padding: 12px;
            margin: 8px 0;
            border-radius: 5px;
            border-left: 3px solid #48bb78;
            font-family: monospace;
        }
        
        .highlight {
            background: #fef3c7;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: 600;
        }
        
        .key-points {
            background: #e6f7ff;
            border-left: 4px solid #1890ff;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        
        .key-points ul {
            margin-left: 20px;
            margin-top: 10px;
        }
        
        .key-points li {
            margin: 8px 0;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üöÄ Express.js Request & Response Handling</h1>
            <p>Understanding the core of Express.js web applications</p>
        </header>
        
        <div class="content">
            <!-- Introduction Section -->
            <div class="section">
                <h2>üìö What is Express.js?</h2>
                <p>Express.js is a minimal and flexible Node.js web application framework that provides a robust set of features for web and mobile applications. At its core, Express handles <span class="highlight">requests</span> from clients and sends back <span class="highlight">responses</span>.</p>
                
                <div class="analogy">
                    <strong>üçΩÔ∏è Restaurant Analogy:</strong>
                    Think of Express as a restaurant. The <strong>request</strong> is like a customer's order (what they want), and the <strong>response</strong> is like the waiter bringing the food (what they get back). Express acts as the kitchen system that processes orders and prepares responses.
                </div>
            </div>

            <!-- Request Object Section -->
            <div class="section">
                <h2>üì• The Request Object (req)</h2>
                <p>The request object represents the HTTP request and contains information about what the client is asking for.</p>
                
                <h3>Common Request Properties:</h3>
                <pre><span class="comment">// Basic Express route handler</span>
<span class="keyword">app</span>.<span class="function">get</span>(<span class="string">'/user'</span>, (<span class="property">req</span>, <span class="property">res</span>) => {
  
  <span class="comment">// 1. req.params - URL parameters</span>
  <span class="keyword">const</span> userId = <span class="property">req</span>.<span class="property">params</span>.id;
  <span class="comment">// Example: /user/123 ‚Üí { id: '123' }</span>
  
  <span class="comment">// 2. req.query - Query string parameters</span>
  <span class="keyword">const</span> search = <span class="property">req</span>.<span class="property">query</span>.search;
  <span class="comment">// Example: /user?search=john ‚Üí { search: 'john' }</span>
  
  <span class="comment">// 3. req.body - Request body (POST/PUT data)</span>
  <span class="keyword">const</span> userData = <span class="property">req</span>.<span class="property">body</span>;
  <span class="comment">// Example: { name: 'John', age: 30 }</span>
  
  <span class="comment">// 4. req.headers - HTTP headers</span>
  <span class="keyword">const</span> contentType = <span class="property">req</span>.<span class="property">headers</span>[<span class="string">'content-type'</span>];
  
  <span class="comment">// 5. req.method - HTTP method (GET, POST, etc.)</span>
  <span class="keyword">const</span> method = <span class="property">req</span>.<span class="property">method</span>;
  
  <span class="comment">// 6. req.url - Full URL path</span>
  <span class="keyword">const</span> fullUrl = <span class="property">req</span>.<span class="property">url</span>;
  
});</pre>

                <div class="key-points">
                    <strong>üîë Key Points:</strong>
                    <ul>
                        <li><strong>req.params</strong>: Data from URL path (e.g., /user/:id)</li>
                        <li><strong>req.query</strong>: Data from query string (e.g., ?search=value)</li>
                        <li><strong>req.body</strong>: Data sent in request body (requires middleware)</li>
                        <li><strong>req.headers</strong>: HTTP headers from the client</li>
                    </ul>
                </div>
            </div>

            <!-- Response Object Section -->
            <div class="section">
                <h2>üì§ The Response Object (res)</h2>
                <p>The response object represents the HTTP response that Express sends back to the client.</p>
                
                <h3>Common Response Methods:</h3>
                <pre><span class="comment">// Different ways to send responses</span>
<span class="keyword">app</span>.<span class="function">get</span>(<span class="string">'/api/data'</span>, (<span class="property">req</span>, <span class="property">res</span>) => {
  
  <span class="comment">// 1. res.send() - Send various types of data</span>
  <span class="property">res</span>.<span class="function">send</span>(<span class="string">'Hello World'</span>);
  <span class="property">res</span>.<span class="function">send</span>({ <span class="property">message</span>: <span class="string">'Success'</span> });
  
  <span class="comment">// 2. res.json() - Send JSON response</span>
  <span class="property">res</span>.<span class="function">json</span>({ 
    <span class="property">user</span>: <span class="string">'John'</span>, 
    <span class="property">age</span>: <span class="string">30</span> 
  });
  
  <span class="comment">// 3. res.status() - Set HTTP status code</span>
  <span class="property">res</span>.<span class="function">status</span>(<span class="string">404</span>).<span class="function">send</span>(<span class="string">'Not Found'</span>);
  <span class="property">res</span>.<span class="function">status</span>(<span class="string">201</span>).<span class="function">json</span>({ <span class="property">created</span>: <span class="keyword">true</span> });
  
  <span class="comment">// 4. res.redirect() - Redirect to another URL</span>
  <span class="property">res</span>.<span class="function">redirect</span>(<span class="string">'/home'</span>);
  <span class="property">res</span>.<span class="function">redirect</span>(<span class="string">301</span>, <span class="string">'https://example.com'</span>);
  
  <span class="comment">// 5. res.render() - Render a view template</span>
  <span class="property">res</span>.<span class="function">render</span>(<span class="string">'index'</span>, { <span class="property">title</span>: <span class="string">'Home'</span> });
  
  <span class="comment">// 6. res.set() - Set response headers</span>
  <span class="property">res</span>.<span class="function">set</span>(<span class="string">'Content-Type'</span>, <span class="string">'text/html'</span>);
  
});</pre>

                <div class="analogy">
                    <strong>üìÆ Post Office Analogy:</strong>
                    The response methods are like different ways to send a package:
                    <ul style="margin-top: 10px; margin-left: 20px;">
                        <li><strong>res.send()</strong>: Regular mail - send anything</li>
                        <li><strong>res.json()</strong>: Certified mail - structured data</li>
                        <li><strong>res.status()</strong>: Priority label - importance indicator</li>
                        <li><strong>res.redirect()</strong>: Forward address - send them elsewhere</li>
                    </ul>
                </div>
            </div>

            <!-- Complete Example -->
            <div class="section">
                <h2>üí° Complete Example</h2>
                <pre><span class="keyword">const</span> express = <span class="function">require</span>(<span class="string">'express'</span>);
<span class="keyword">const</span> app = <span class="function">express</span>();

<span class="comment">// Middleware to parse JSON bodies</span>
<span class="keyword">app</span>.<span class="function">use</span>(express.<span class="function">json</span>());

<span class="comment">// GET request - Retrieve user data</span>
<span class="keyword">app</span>.<span class="function">get</span>(<span class="string">'/api/users/:id'</span>, (<span class="property">req</span>, <span class="property">res</span>) => {
  <span class="keyword">const</span> userId = <span class="property">req</span>.<span class="property">params</span>.id;
  <span class="keyword">const</span> format = <span class="property">req</span>.<span class="property">query</span>.format;
  
  <span class="comment">// Simulated database lookup</span>
  <span class="keyword">const</span> user = { 
    <span class="property">id</span>: userId, 
    <span class="property">name</span>: <span class="string">'John Doe'</span>, 
    <span class="property">email</span>: <span class="string">'john@example.com'</span> 
  };
  
  <span class="keyword">if</span> (format === <span class="string">'xml'</span>) {
    <span class="property">res</span>.<span class="function">set</span>(<span class="string">'Content-Type'</span>, <span class="string">'text/xml'</span>);
    <span class="property">res</span>.<span class="function">send</span>(<span class="string">'&lt;user&gt;&lt;name&gt;John Doe&lt;/name&gt;&lt;/user&gt;'</span>);
  } <span class="keyword">else</span> {
    <span class="property">res</span>.<span class="function">json</span>(user);
  }
});

<span class="comment">// POST request - Create new user</span>
<span class="keyword">app</span>.<span class="function">post</span>(<span class="string">'/api/users'</span>, (<span class="property">req</span>, <span class="property">res</span>) => {
  <span class="keyword">const</span> { name, email } = <span class="property">req</span>.<span class="property">body</span>;
  
  <span class="comment">// Validate data</span>
  <span class="keyword">if</span> (!name || !email) {
    <span class="keyword">return</span> <span class="property">res</span>.<span class="function">status</span>(<span class="string">400</span>).<span class="function">json</span>({ 
      <span class="property">error</span>: <span class="string">'Name and email are required'</span> 
    });
  }
  
  <span class="comment">// Create user (simulated)</span>
  <span class="keyword">const</span> newUser = { 
    <span class="property">id</span>: Date.<span class="function">now</span>(), 
    <span class="property">name</span>, 
    <span class="property">email</span> 
  };
  
  <span class="property">res</span>.<span class="function">status</span>(<span class="string">201</span>).<span class="function">json</span>(newUser);
});

<span class="comment">// Error handling</span>
<span class="keyword">app</span>.<span class="function">use</span>((<span class="property">req</span>, <span class="property">res</span>) => {
  <span class="property">res</span>.<span class="function">status</span>(<span class="string">404</span>).<span class="function">json</span>({ 
    <span class="property">error</span>: <span class="string">'Route not found'</span> 
  });
});

<span class="keyword">app</span>.<span class="function">listen</span>(<span class="string">3000</span>, () => {
  console.<span class="function">log</span>(<span class="string">'Server running on port 3000'</span>);
});</pre>
            </div>

            <!-- Interactive Demo -->
            <div class="section">
                <h2>üéÆ Interactive Demo</h2>
                <p>Simulate Express.js request and response handling:</p>
                
                <div class="interactive-demo">
                    <div class="demo-controls">
                        <div class="control-group">
                            <label>HTTP Method:</label>
                            <select id="method">
                                <option value="GET">GET</option>
                                <option value="POST">POST</option>
                                <option value="PUT">PUT</option>
                                <option value="DELETE">DELETE</option>
                            </select>
                        </div>
                        
                        <div class="control-group">
                            <label>Route Path:</label>
                            <input type="text" id="route" value="/api/users/123" placeholder="/api/users/123">
                        </div>
                        
                        <div class="control-group">
                            <label>Query String:</label>
                            <input type="text" id="query" value="format=json&limit=10" placeholder="key=value&key2=value2">
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label>Request Body (JSON):</label>
                        <input type="text" id="body" value='{"name":"John","email":"john@example.com"}' placeholder='{"key": "value"}'>
                    </div>
                    
                    <button onclick="simulateRequest()" style="margin-top: 15px;">Send Request üöÄ</button>
                    
                    <div id="output" class="output" style="display: none;">
                        <h4>üìä Request & Response Details:</h4>
                        <div id="outputContent"></div>
                    </div>
                </div>
            </div>

            <!-- Best Practices -->
            <div class="section">
                <h2>‚úÖ Best Practices</h2>
                <div class="key-points">
                    <ul>
                        <li><strong>Always validate input:</strong> Check req.body, req.params, and req.query before using them</li>
                        <li><strong>Use appropriate status codes:</strong> 200 (OK), 201 (Created), 400 (Bad Request), 404 (Not Found), 500 (Server Error)</li>
                        <li><strong>Chain response methods:</strong> res.status(200).json({...}) for cleaner code</li>
                        <li><strong>Handle errors:</strong> Use try-catch blocks and error middleware</li>
                        <li><strong>Use middleware:</strong> express.json() for parsing JSON, express.urlencoded() for form data</li>
                        <li><strong>Don't send multiple responses:</strong> Only call res.send(), res.json(), etc. once per request</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        function simulateRequest() {
            const method = document.getElementById('method').value;
            const route = document.getElementById('route').value;
            const query = document.getElementById('query').value;
            const body = document.getElementById('body').value;
            
            // Parse route for params
            const routeParts = route.split('/').filter(p => p);
            const params = {};
            routeParts.forEach((part, index) => {
                if (!isNaN(part)) {
                    params[`param${index}`] = part;
                }
            });
            
            // Parse query string
            const queryParams = {};
            if (query) {
                query.split('&').forEach(pair => {
                    const [key, value] = pair.split('=');
                    if (key && value) {
                        queryParams[key] = value;
                    }
                });
            }
            
            // Parse body
            let bodyData = {};
            try {
                if (body && body.trim()) {
                    bodyData = JSON.parse(body);
                }
            } catch (e) {
                bodyData = { error: 'Invalid JSON' };
            }
            
            // Simulate response
            let statusCode = 200;
            let responseData = {};
            
            if (method === 'GET') {
                responseData = {
                    message: 'Data retrieved successfully',
                    data: { id: params.param2 || '123', name: 'John Doe' }
                };
            } else if (method === 'POST') {
                statusCode = 201;
                responseData = {
                    message: 'Resource created successfully',
                    data: { id: Date.now(), ...bodyData }
                };
            } else if (method === 'PUT') {
                responseData = {
                    message: 'Resource updated successfully',
                    data: { id: params.param2 || '123', ...bodyData }
                };
            } else if (method === 'DELETE') {
                statusCode = 204;
                responseData = { message: 'Resource deleted successfully' };
            }
            
            // Display output
            const output = document.getElementById('output');
            const outputContent = document.getElementById('outputContent');
            
            outputContent.innerHTML = `
                <div class="output-item"><strong>Request Method:</strong> ${method}</div>
                <div class="output-item"><strong>Request URL:</strong> ${route}${query ? '?' + query : ''}</div>
                <div class="output-item"><strong>req.params:</strong> ${JSON.stringify(params)}</div>
                <div class="output-item"><strong>req.query:</strong> ${JSON.stringify(queryParams)}</div>
                <div class="output-item"><strong>req.body:</strong> ${JSON.stringify(bodyData, null, 2)}</div>
                <div class="output-item" style="border-left-color: #f59e0b;"><strong>Response Status:</strong> ${statusCode}</div>
                <div class="output-item" style="border-left-color: #f59e0b;"><strong>Response Data:</strong> ${JSON.stringify(responseData, null, 2)}</div>
            `;
            
            output.style.display = 'block';
        }
        
        // Run demo on load
        window.addEventListener('load', () => {
            setTimeout(simulateRequest, 500);
        });
    </script>
</body>
</html>