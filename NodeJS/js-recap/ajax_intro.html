<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive AJAX Demonstration</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        h2 {
            color: #4a5568;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
            margin-top: 40px;
        }

        h3 {
            color: #2d3748;
            margin-top: 25px;
        }

        .concept-card {
            background: #f7fafc;
            border-left: 5px solid #4299e1;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .analogy {
            background: #e6fffa;
            border-left: 5px solid #38b2ac;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            font-style: italic;
        }

        .demo-section {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        pre {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 10px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            line-height: 1.5;
            border: 1px solid #4a5568;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .result-box {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            min-height: 50px;
        }

        .success {
            border-color: #48bb78;
            background: #f0fff4;
        }

        .error {
            border-color: #f56565;
            background: #fff5f5;
        }

        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .tab:hover {
            background: #f7fafc;
        }

        .tab.active {
            border-bottom-color: #667eea;
            color: #667eea;
            font-weight: bold;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e2e8f0;
            border-radius: 5px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Interactive AJAX Demonstration</h1>
        
        <div class="concept-card">
            <h2>What is AJAX? ü§î</h2>
            <p><strong>AJAX</strong> stands for <strong>Asynchronous JavaScript and XML</strong> (though nowadays we often use JSON instead of XML). It's a technique that allows web pages to communicate with servers in the background without refreshing the entire page.</p>
            
            <div class="analogy">
                <strong>üí° Real-World Analogy:</strong> Think of AJAX like ordering food through a mobile app while watching TV. You can continue watching your show (the webpage stays active) while your order is being processed in the background. Once ready, you get a notification (the response) without having to stop what you're doing or refresh your TV screen!
            </div>
        </div>

        <div class="concept-card">
            <h2>Key AJAX Concepts üîë</h2>
            
            <h3>1. Asynchronous Nature</h3>
            <p>AJAX requests don't block the user interface. Users can continue interacting with the page while data is being fetched.</p>
            
            <div class="analogy">
                <strong>üèÉ‚Äç‚ôÇÔ∏è Analogy:</strong> It's like sending a text message. You send it and continue with your day without waiting by the phone. When a reply comes, you get notified.
            </div>

            <h3>2. XMLHttpRequest Object</h3>
            <p>The traditional way to make AJAX requests using the built-in XMLHttpRequest object.</p>

            <h3>3. Fetch API</h3>
            <p>The modern, promise-based approach to making HTTP requests that's cleaner and more intuitive.</p>
            
            <div class="analogy">
                <strong>üöó Analogy:</strong> If XMLHttpRequest is like driving a manual car (more control but complex), Fetch API is like driving an automatic car (easier and more intuitive).
            </div>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="switchTab('basic')">Basic Examples</div>
            <div class="tab" onclick="switchTab('advanced')">Advanced Features</div>
            <div class="tab" onclick="switchTab('code')">Code Explanations</div>
        </div>

        <div id="basic" class="tab-content active">
            <div class="demo-section">
                <h3>üéØ Demo 1: Fetch Random Quote</h3>
                <p>This demonstrates a simple GET request to fetch data from an API.</p>
                
                <button onclick="fetchQuote()" id="quoteBtn">Get Random Quote</button>
                <div id="quoteResult" class="result-box">Click the button to fetch a random quote!</div>
                
                <h4>How it works:</h4>
                <pre>async function fetchQuote() {
    try {
        // Show loading state
        showLoading('quoteResult', 'quoteBtn');
        
        // Make the AJAX request
        const response = await fetch('https://api.quotable.io/random');
        const data = await response.json();
        
        // Display the result
        displayResult('quoteResult', `"${data.content}" - ${data.author}`, 'success');
    } catch (error) {
        displayResult('quoteResult', 'Error fetching quote: ' + error.message, 'error');
    } finally {
        hideLoading('quoteBtn');
    }
}</pre>
            </div>

            <div class="demo-section">
                <h3>üåç Demo 2: Get User Location Info</h3>
                <p>Demonstrates fetching data based on IP address (no personal data stored).</p>
                
                <button onclick="getLocationInfo()" id="locationBtn">Get My Location Info</button>
                <div id="locationResult" class="result-box">Click to get general location information based on your IP!</div>
                
                <h4>Code explanation:</h4>
                <pre>async function getLocationInfo() {
    try {
        showLoading('locationResult', 'locationBtn');
        
        // Fetch IP-based location data
        const response = await fetch('https://ipapi.co/json/');
        const data = await response.json();
        
        const info = `
            üåç Location: ${data.city}, ${data.region}, ${data.country_name}
            üè¢ ISP: ${data.org}
            üåê IP: ${data.ip}
        `;
        
        displayResult('locationResult', info, 'success');
    } catch (error) {
        displayResult('locationResult', 'Could not fetch location: ' + error.message, 'error');
    } finally {
        hideLoading('locationBtn');
    }
}</pre>
            </div>
        </div>

        <div id="advanced" class="tab-content">
            <div class="demo-section">
                <h3>‚ö° Demo 3: Multiple Requests with Progress</h3>
                <p>Shows how to make multiple AJAX requests and track progress.</p>
                
                <button onclick="fetchMultipleData()" id="multiBtn">Fetch Multiple APIs</button>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div id="multiResult" class="result-box">Click to fetch data from multiple sources!</div>
                
                <h4>Advanced features demonstrated:</h4>
                <ul>
                    <li>Promise.all() for parallel requests</li>
                    <li>Progress tracking</li>
                    <li>Error handling for multiple requests</li>
                    <li>Timeout handling</li>
                </ul>
            </div>

            <div class="demo-section">
                <h3>üîÑ Demo 4: Simulated Form Submission</h3>
                <p>Demonstrates POST request simulation (data is not actually sent anywhere).</p>
                
                <input type="text" id="nameInput" placeholder="Enter your name" style="padding: 10px; margin: 5px; border: 1px solid #ccc; border-radius: 5px;">
                <input type="email" id="emailInput" placeholder="Enter your email" style="padding: 10px; margin: 5px; border: 1px solid #ccc; border-radius: 5px;">
                <br>
                <button onclick="simulateFormSubmission()" id="formBtn">Submit Form (Simulated)</button>
                <div id="formResult" class="result-box">Fill in the form and click submit!</div>
            </div>
        </div>

        <div id="code" class="tab-content">
            <div class="demo-section">
                <h3>üìö XMLHttpRequest vs Fetch API</h3>
                
                <h4>Old Way - XMLHttpRequest:</h4>
                <pre>// Traditional XMLHttpRequest approach
function makeRequestOldWay(url, callback) {
    const xhr = new XMLHttpRequest();
    
    xhr.onreadystatechange = function() {
        if (xhr.readyState === 4) {  // Request completed
            if (xhr.status === 200) {  // Success
                callback(null, JSON.parse(xhr.responseText));
            } else {
                callback(new Error('Request failed: ' + xhr.status));
            }
        }
    };
    
    xhr.open('GET', url, true);  // true = asynchronous
    xhr.send();
}</pre>

                <h4>Modern Way - Fetch API:</h4>
                <pre>// Modern Fetch API approach
async function makeRequestModernWay(url) {
    try {
        const response = await fetch(url);
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        return data;
    } catch (error) {
        console.error('Fetch error:', error);
        throw error;
    }
}</pre>

                <div class="analogy">
                    <strong>üîß Why Fetch is Better:</strong> XMLHttpRequest is like using a complicated Swiss Army knife for everything, while Fetch API is like having the right tool for each job - cleaner, more intuitive, and promise-based!
                </div>
            </div>

            <div class="demo-section">
                <h3>üé≠ AJAX States and Lifecycle</h3>
                <pre>// AJAX Request Lifecycle with Fetch
async function demonstrateAJAXLifecycle() {
    console.log('1. üöÄ Request initiated');
    
    try {
        console.log('2. ‚è≥ Sending request...');
        const response = await fetch('https://api.example.com/data');
        
        console.log('3. üì° Response received');
        console.log('   - Status:', response.status);
        console.log('   - Headers:', response.headers);
        
        console.log('4. üîÑ Processing response...');
        const data = await response.json();
        
        console.log('5. ‚úÖ Success! Data processed');
        return data;
        
    } catch (error) {
        console.log('5. ‚ùå Error occurred:', error.message);
        throw error;
    }
}</pre>
            </div>

            <div class="demo-section">
                <h3>üõ°Ô∏è Best Practices</h3>
                <pre>// AJAX Best Practices Example
class AJAXManager {
    constructor() {
        this.cache = new Map();
        this.requestTimeout = 10000; // 10 seconds
    }
    
    async makeRequest(url, options = {}) {
        // 1. Check cache first
        if (this.cache.has(url)) {
            return this.cache.get(url);
        }
        
        // 2. Add timeout
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), this.requestTimeout);
        
        try {
            // 3. Make request with timeout
            const response = await fetch(url, {
                ...options,
                signal: controller.signal
            });
            
            // 4. Clear timeout on success
            clearTimeout(timeoutId);
            
            // 5. Check response status
            if (!response.ok) {
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            
            const data = await response.json();
            
            // 6. Cache successful responses
            this.cache.set(url, data);
            
            return data;
            
        } catch (error) {
            clearTimeout(timeoutId);
            
            // 7. Handle different error types
            if (error.name === 'AbortError') {
                throw new Error('Request timed out');
            }
            throw error;
        }
    }
}</pre>
            </div>
        </div>
    </div>

    <script>
        // Global variables for demo
        let requestCount = 0;
        
        // Tab switching functionality
        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }
        
        // Helper functions for UI feedback
        function showLoading(resultId, buttonId) {
            const resultDiv = document.getElementById(resultId);
            const button = document.getElementById(buttonId);
            
            resultDiv.innerHTML = '<div class="loading"></div>Loading...';
            resultDiv.className = 'result-box';
            button.disabled = true;
        }
        
        function hideLoading(buttonId) {
            const button = document.getElementById(buttonId);
            button.disabled = false;
        }
        
        function displayResult(resultId, content, type = 'success') {
            const resultDiv = document.getElementById(resultId);
            resultDiv.innerHTML = content;
            resultDiv.className = `result-box ${type}`;
        }
        
        // Demo 1: Fetch Random Quote
        async function fetchQuote() {
            try {
                showLoading('quoteResult', 'quoteBtn');
                
                const response = await fetch('https://api.quotable.io/random');
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                
                const data = await response.json();
                const result = `
                    <strong>üìù Quote:</strong> "${data.content}"<br>
                    <strong>‚úçÔ∏è Author:</strong> ${data.author}<br>
                    <strong>üè∑Ô∏è Tags:</strong> ${data.tags.join(', ')}
                `;
                
                displayResult('quoteResult', result, 'success');
                
            } catch (error) {
                displayResult('quoteResult', `‚ùå Error: ${error.message}`, 'error');
            } finally {
                hideLoading('quoteBtn');
            }
        }
        
        // Demo 2: Get Location Info
        async function getLocationInfo() {
            try {
                showLoading('locationResult', 'locationBtn');
                
                const response = await fetch('https://ipapi.co/json/');
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                
                const data = await response.json();
                const result = `
                    <strong>üåç Location:</strong> ${data.city}, ${data.region}, ${data.country_name}<br>
                    <strong>üè¢ ISP:</strong> ${data.org}<br>
                    <strong>üåê IP:</strong> ${data.ip}<br>
                    <strong>‚è∞ Timezone:</strong> ${data.timezone}
                `;
                
                displayResult('locationResult', result, 'success');
                
            } catch (error) {
                displayResult('locationResult', `‚ùå Could not fetch location: ${error.message}`, 'error');
            } finally {
                hideLoading('locationBtn');
            }
        }
        
        // Demo 3: Multiple Requests with Progress
        async function fetchMultipleData() {
            try {
                const button = document.getElementById('multiBtn');
                button.disabled = true;
                
                const progressFill = document.getElementById('progressFill');
                const resultDiv = document.getElementById('multiResult');
                
                resultDiv.innerHTML = 'üöÄ Starting multiple requests...';
                resultDiv.className = 'result-box';
                
                const apis = [
                    { name: 'Quote', url: 'https://api.quotable.io/random' },
                    { name: 'Cat Fact', url: 'https://catfact.ninja/fact' },
                    { name: 'Dog Image', url: 'https://dog.ceo/api/breeds/image/random' }
                ];
                
                let completed = 0;
                const results = {};
                
                // Function to update progress
                function updateProgress() {
                    const percentage = (completed / apis.length) * 100;
                    progressFill.style.width = percentage + '%';
                }
                
                // Make all requests in parallel
                const promises = apis.map(async (api, index) => {
                    try {
                        const response = await fetch(api.url);
                        const data = await response.json();
                        
                        results[api.name] = data;
                        completed++;
                        updateProgress();
                        
                        resultDiv.innerHTML += `<br>‚úÖ ${api.name} completed`;
                        
                        return { name: api.name, data, success: true };
                    } catch (error) {
                        completed++;
                        updateProgress();
                        resultDiv.innerHTML += `<br>‚ùå ${api.name} failed`;
                        return { name: api.name, error: error.message, success: false };
                    }
                });
                
                const allResults = await Promise.all(promises);
                
                // Display final results
                let finalResult = '<h4>üìä Results Summary:</h4>';
                allResults.forEach(result => {
                    if (result.success) {
                        finalResult += `<p><strong>‚úÖ ${result.name}:</strong> Success</p>`;
                    } else {
                        finalResult += `<p><strong>‚ùå ${result.name}:</strong> ${result.error}</p>`;
                    }
                });
                
                displayResult('multiResult', finalResult, 'success');
                
            } catch (error) {
                displayResult('multiResult', `‚ùå Error in multiple requests: ${error.message}`, 'error');
            } finally {
                document.getElementById('multiBtn').disabled = false;
                document.getElementById('progressFill').style.width = '100%';
            }
        }
        
        // Demo 4: Simulated Form Submission
        async function simulateFormSubmission() {
            const name = document.getElementById('nameInput').value;
            const email = document.getElementById('emailInput').value;
            
            if (!name || !email) {
                displayResult('formResult', '‚ùå Please fill in all fields!', 'error');
                return;
            }
            
            try {
                showLoading('formResult', 'formBtn');
                
                // Simulate network delay
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // Simulate form data (not actually sent anywhere)
                const formData = {
                    name: name,
                    email: email,
                    timestamp: new Date().toISOString(),
                    id: Math.random().toString(36).substr(2, 9)
                };
                
                const result = `
                    <h4>‚úÖ Form Submitted Successfully!</h4>
                    <p><strong>Name:</strong> ${formData.name}</p>
                    <p><strong>Email:</strong> ${formData.email}</p>
                    <p><strong>Submission ID:</strong> ${formData.id}</p>
                    <p><strong>Time:</strong> ${new Date(formData.timestamp).toLocaleString()}</p>
                    <p><em>Note: This is a simulation - no data was actually sent.</em></p>
                `;
                
                displayResult('formResult', result, 'success');
                
                // Clear form
                document.getElementById('nameInput').value = '';
                document.getElementById('emailInput').value = '';
                
            } catch (error) {
                displayResult('formResult', `‚ùå Submission failed: ${error.message}`, 'error');
            } finally {
                hideLoading('formBtn');
            }
        }
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üéâ AJAX Demo Page Loaded!');
            console.log('Try the different examples to see AJAX in action.');
        });
    </script>
</body>
</html>